(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{161:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return r})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return s}));var a=n(1),o=n(9),i=(n(0),n(187)),r={id:"skeleton_forms",title:"Forms",sidebar_label:"Forms"},l={id:"skeleton/skeleton_forms",title:"Forms",description:"We use [react-final-form](https://final-form.org/react) to handle form state. To connect your React component with final form we recommend to use [withFinalForm](/(/frontend-docs/docs//resources/resource_withFinalForm) HOC that includes some common code to work with REST API and form elements.",source:"@site/docs/skeleton/forms.md",permalink:"/frontend-docs/docs/skeleton/skeleton_forms",editUrl:"https://github.com/django-stars/frontend-docs/tree/master/docs/skeleton/forms.md",sidebar_label:"Forms",sidebar:"skeltonSitebar",previous:{title:"Architecture",permalink:"/frontend-docs/docs/skeleton/skeleton_architecture"},next:{title:"Access levels",permalink:"/frontend-docs/docs/skeleton/skeleton_access"}},c=[{value:"<del>BaseFieldHOC</del>",id:"basefieldhoc",children:[]},{value:"<del>BaseFieldLayout</del>",id:"basefieldlayout",children:[]},{value:"<del>inputs</del>",id:"inputs",children:[]},{value:"<del>fields.js</del>",id:"fieldsjs",children:[]},{value:"<del>validation</del>",id:"validation",children:[{value:"<del>form level validation</del>",id:"form-level-validation",children:[]},{value:"<del>field level validation</del>",id:"field-level-validation",children:[]},{value:"<del>conditional validation</del>",id:"conditional-validation",children:[]}]},{value:"<del>change one field based on another field</del>",id:"change-one-field-based-on-another-field",children:[]}],d={rightToc:c};function s(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},d,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"We use ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://final-form.org/react"}),"react-final-form")," to handle form state. To connect your React component with final form we recommend to use ","[withFinalForm]","(/(/frontend-docs/docs//resources/resource_withFinalForm) HOC that includes some common code to work with REST API and form elements."),Object(i.b)("p",null,"To make form's javascript code more reusable you can use ",Object(i.b)("inlineCode",{parentName:"p"},"common/forms")," folder and put all standend inputs there."),Object(i.b)("h2",{id:"basefieldhoc"},Object(i.b)("del",{parentName:"h2"},"BaseFieldHOC")),Object(i.b)("p",null,"Is HOC to wrap your input with react-final-form. This function will wrap input component with ","[Field]","(",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://final-form.org/(/frontend-docs/docs//react-final-form/api/Field"}),"https://final-form.org/(/frontend-docs/docs//react-final-form/api/Field"),") component to pass all props from react-final-form. And additionally wrap input with BaseFieldLayout. "),Object(i.b)("h2",{id:"basefieldlayout"},Object(i.b)("del",{parentName:"h2"},"BaseFieldLayout")),Object(i.b)("p",null,"Mostly all yout inputs will have same layout to wrap input element with label, define some accessibility props, show lable, errors, is required, show some additional html elements such as ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://material-ui.com/api/input-adornment/"}),"InputAdornment"),", ext... To avoid same code and make all form elements more reusable you should use BaseFieldLayout that is part of BaseFieldHOC and defines all html elements that are common for whatever input component."),Object(i.b)("h2",{id:"inputs"},Object(i.b)("del",{parentName:"h2"},"inputs")),Object(i.b)("p",null,"Now all props to input is already defined with BaseFieldHOC and all additional html element are defined with BaseFieldLayout and everything is left to create input compnent. All input component it is better to store in ",Object(i.b)("inlineCode",{parentName:"p"},"inputs")," folder. Input component now should not contain any dublicate code and should be simple as much as it could be)"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-jsx"}),"export default function TextInput({ onChange, inputClassName, ...props }) {\n  const handleChange = useCallback((e) => onChange(e.target.value), [onChange])\n  return (\n    <input\n      {...props}\n      className={inputClassName}\n      onChange={handleChange}\n    />\n  )\n}\n")),Object(i.b)("h2",{id:"fieldsjs"},Object(i.b)("del",{parentName:"h2"},"fields.js")),Object(i.b)("p",null,"Now when you have your input component you just need to wrap this Component with BaseFieldHOC. And this should be done in ",Object(i.b)("inlineCode",{parentName:"p"},"fields.js")," file. "),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-javascript"}),"import TextInput from './inputs/TextInput'\n\nconst TextField = BaseFieldHOC(TextInput)\n\nexport {\n  TextField\n}\n")),Object(i.b)("div",{className:"admonition admonition-caution alert alert--warning"},Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"}),Object(i.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})))),"caution")),Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"Please, pay attantion that input Component shout have name ",Object(i.b)("inlineCode",{parentName:"p"},"<type>Input")," and field ",Object(i.b)("inlineCode",{parentName:"p"},"<type>Field")))),Object(i.b)("h2",{id:"validation"},Object(i.b)("del",{parentName:"h2"},"validation")),Object(i.b)("p",null,"Based on react-final-form API you can use ","[form level validation]","(",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://final-form.org/(/frontend-docs/docs//react-final-form/examples/record-level-validation"}),"https://final-form.org/(/frontend-docs/docs//react-final-form/examples/record-level-validation"),") and ","[fiels level validation]","(",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://final-form.org/(/frontend-docs/docs//react-final-form/examples/field-level-validation)"}),"https://final-form.org/(/frontend-docs/docs//react-final-form/examples/field-level-validation)"),". Skeleton includes basic examples of validations. You can find this solution in 'common/form/validation' folder."),Object(i.b)("h3",{id:"form-level-validation"},Object(i.b)("del",{parentName:"h3"},"form level validation")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-javascript"}),"import { validateEmail, validateRequired, compose } from 'common/forms/validation'\n\nexport default compose(\n  validateEmail('email'),\n  validateRequired(['email', 'password']),\n)\n")),Object(i.b)("p",null,"This will check fields with names ",Object(i.b)("inlineCode",{parentName:"p"},"email")," and ",Object(i.b)("inlineCode",{parentName:"p"},"password")," to be defined and field check ",Object(i.b)("inlineCode",{parentName:"p"},"email")," field with email reqexp."),Object(i.b)("div",{className:"admonition admonition-caution alert alert--warning"},Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"}),Object(i.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})))),"caution")),Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"Please, pay attantion that form level validation could not contain validation rules for inputs that are not exits in form.\nFor example if you define rule for field ",Object(i.b)("inlineCode",{parentName:"p"},"name")," to be required and than you delete this input from JSX than your form will be always invalid."))),Object(i.b)("h3",{id:"field-level-validation"},Object(i.b)("del",{parentName:"h3"},"field level validation")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-javascript"}),"import { email, required, composeValidators } from 'common/forms/validation'\n\nconst validateEmail = composeValidators(email, required)\n\nfunction MyForm(){\n  return (\n    <TextInput\n      name=\"email\"\n      validate={validateEmail}\n    />\n  )\n}\n")),Object(i.b)("div",{className:"admonition admonition-caution alert alert--warning"},Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"}),Object(i.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})))),"caution")),Object(i.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"Please, pay attantion that you can not use ",Object(i.b)("inlineCode",{parentName:"p"},"composeValidators")," inside your React Component. It is important that validate function should be unique during all React Component lifecicle."))),Object(i.b)("h3",{id:"conditional-validation"},Object(i.b)("del",{parentName:"h3"},"conditional validation")),Object(i.b)("p",null,"react-final-form API memoized validate function prop. The best way to handle condition validation is to descripe validate function more correctly."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-javascript"}),"import { email, required, composeValidators } from 'common/forms/validation'\n\nfunction conditionalRequired(value, allValues){\n  if(!allValues.anotherInput) return undefined\n  return composeValidators(required, email)(value)\n}\n\nfunction MyForm(){\n  return (\n    <TextInput\n      name=\"email\"\n      validate={conditionalRequired}\n    />\n  )\n}\n")),Object(i.b)("h2",{id:"change-one-field-based-on-another-field"},Object(i.b)("del",{parentName:"h2"},"change one field based on another field")),Object(i.b)("p",null,"To make some form state changes on field change it is recommended to use ","[decorators]","(",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://final-form.org/(/frontend-docs/docs//final-form/types/Decorator"}),"https://final-form.org/(/frontend-docs/docs//final-form/types/Decorator"),")"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-javascript"}),"const transferFormdecorator = createDecorator({\n  field: /total/,\n  updates: (value, name, allValues) => {\n    return set(allValues, name.replace('.total', '.debts'), [])\n  },\n})\n\n\nfinalForm(\n  {\n    decorators: [transferFormdecorator],\n  }\n)\n")),Object(i.b)("p",null,"In this example you will subscribe on change for all fields inside fields array with name that includes ",Object(i.b)("inlineCode",{parentName:"p"},"total")," in their name and update relevalt field with name ",Object(i.b)("inlineCode",{parentName:"p"},"debts")," to empty array. "))}s.isMDXComponent=!0},187:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return u}));var a=n(0),o=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var d=o.a.createContext({}),s=function(e){var t=o.a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):l({},t,{},e)),n},m=function(e){var t=s(e.components);return o.a.createElement(d.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},b=Object(a.forwardRef)((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,r=e.parentName,d=c(e,["components","mdxType","originalType","parentName"]),m=s(n),b=a,u=m["".concat(r,".").concat(b)]||m[b]||p[b]||i;return n?o.a.createElement(u,l({ref:t},d,{components:n})):o.a.createElement(u,l({ref:t},d))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,r=new Array(i);r[0]=b;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:a,r[1]=l;for(var d=2;d<i;d++)r[d]=n[d];return o.a.createElement.apply(null,r)}return o.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"}}]);